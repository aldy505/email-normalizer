import { expect, test } from "vitest";
import { normalizeEmail } from "../src/index.js";

test.each([
	["john.doe+github@fastmail.com", "john.doe@fastmail.com"],
	["john.doe@fastmail.com", "john.doe@fastmail.com"],
	["john.doe+github@messagingengine.com", "john.doe@messagingengine.com"],
	["john.doe@messagingengine.com", "john.doe@messagingengine.com"],
	["john.doe+github@fastmail.fm", "john.doe@fastmail.fm"],
	["john.doe@fastmail.fm", "john.doe@fastmail.fm"],
	["John.Doe+123@icloud.com", "john.doe@icloud.com"],
	["John.Doe@icloud.com", "john.doe@icloud.com"],
	["John.Doe+123@me.com", "john.doe@me.com"],
	["John.Doe@me.com", "john.doe@me.com"],
	["john.doe+github@mac.com", "john.doe@mac.com"],
	["john.doe@mac.com", "john.doe@mac.com"],
	["John.Doe+github@yahoo.com.ar", "john.doe@yahoo.com.ar"],
	["John.Doe@yahoo.com.ar", "john.doe@yahoo.com.ar"],
	["John.Doe+github@yahoo.com.au", "john.doe@yahoo.com.au"],
	["John.Doe@yahoo.com.au", "john.doe@yahoo.com.au"],
	["John.Doe+github@yahoo.at", "john.doe@yahoo.at"],
	["John.Doe@yahoo.at", "john.doe@yahoo.at"],
	["John.Doe+github@yahoo.be", "john.doe@yahoo.be"],
	["John.Doe@yahoo.be", "john.doe@yahoo.be"],
	["John.Doe+github@yahoo.com.br", "john.doe@yahoo.com.br"],
	["John.Doe@yahoo.com.br", "john.doe@yahoo.com.br"],
	["John.Doe+github@ca.yahoo.com", "john.doe@ca.yahoo.com"],
	["John.Doe@ca.yahoo.com", "john.doe@ca.yahoo.com"],
	["John.Doe+github@qc.yahoo.com", "john.doe@qc.yahoo.com"],
	["John.Doe@qc.yahoo.com", "john.doe@qc.yahoo.com"],
	["John.Doe+github@yahoo.com.co", "john.doe@yahoo.com.co"],
	["John.Doe@yahoo.com.co", "john.doe@yahoo.com.co"],
	["John.Doe+github@yahoo.com.hr", "john.doe@yahoo.com.hr"],
	["John.Doe@yahoo.com.hr", "john.doe@yahoo.com.hr"],
	["John.Doe+github@yahoo.cz", "john.doe@yahoo.cz"],
	["John.Doe@yahoo.cz", "john.doe@yahoo.cz"],
	["John.Doe+github@yahoo.dk", "john.doe@yahoo.dk"],
	["John.Doe@yahoo.dk", "john.doe@yahoo.dk"],
	["John.Doe+github@yahoo.fi", "john.doe@yahoo.fi"],
	["John.Doe@yahoo.fi", "john.doe@yahoo.fi"],
	["John.Doe+github@yahoo.fr", "john.doe@yahoo.fr"],
	["John.Doe@yahoo.fr", "john.doe@yahoo.fr"],
	["John.Doe+github@yahoo.de", "john.doe@yahoo.de"],
	["John.Doe@yahoo.de", "john.doe@yahoo.de"],
	["John.Doe+github@yahoo.gr", "john.doe@yahoo.gr"],
	["John.Doe@yahoo.gr", "john.doe@yahoo.gr"],
	["John.Doe+github@yahoo.com.hk", "john.doe@yahoo.com.hk"],
	["John.Doe@yahoo.com.hk", "john.doe@yahoo.com.hk"],
	["John.Doe+github@yahoo.hu", "john.doe@yahoo.hu"],
	["John.Doe@yahoo.hu", "john.doe@yahoo.hu"],
	["John.Doe+github@yahoo.co.in", "john.doe@yahoo.co.in"],
	["John.Doe@yahoo.co.in", "john.doe@yahoo.co.in"],
	["John.Doe+github@yahoo.in", "john.doe@yahoo.in"],
	["John.Doe@yahoo.in", "john.doe@yahoo.in"],
	["John.Doe+github@yahoo.co.id", "john.doe@yahoo.co.id"],
	["John.Doe@yahoo.co.id", "john.doe@yahoo.co.id"],
	["John.Doe+github@yahoo.ie", "john.doe@yahoo.ie"],
	["John.Doe@yahoo.ie", "john.doe@yahoo.ie"],
	["John.Doe+github@yahoo.co.il", "john.doe@yahoo.co.il"],
	["John.Doe@yahoo.co.il", "john.doe@yahoo.co.il"],
	["John.Doe+github@yahoo.it", "john.doe@yahoo.it"],
	["John.Doe@yahoo.it", "john.doe@yahoo.it"],
	["John.Doe+github@yahoo.co.jp", "john.doe@yahoo.co.jp"],
	["John.Doe@yahoo.co.jp", "john.doe@yahoo.co.jp"],
	["John.Doe+github@yahoo.com.my", "john.doe@yahoo.com.my"],
	["John.Doe@yahoo.com.my", "john.doe@yahoo.com.my"],
	["John.Doe+github@yahoo.com.mx", "john.doe@yahoo.com.mx"],
	["John.Doe@yahoo.com.mx", "john.doe@yahoo.com.mx"],
	["John.Doe+github@yahoo.ae", "john.doe@yahoo.ae"],
	["John.Doe@yahoo.ae", "john.doe@yahoo.ae"],
	["John.Doe+github@yahoo.nl", "john.doe@yahoo.nl"],
	["John.Doe@yahoo.nl", "john.doe@yahoo.nl"],
	["John.Doe+github@yahoo.co.nz", "john.doe@yahoo.co.nz"],
	["John.Doe@yahoo.co.nz", "john.doe@yahoo.co.nz"],
	["John.Doe+github@yahoo.no", "john.doe@yahoo.no"],
	["John.Doe@yahoo.no", "john.doe@yahoo.no"],
	["John.Doe+github@yahoo.com.ph", "john.doe@yahoo.com.ph"],
	["John.Doe@yahoo.com.ph", "john.doe@yahoo.com.ph"],
	["John.Doe+github@yahoo.pl", "john.doe@yahoo.pl"],
	["John.Doe@yahoo.pl", "john.doe@yahoo.pl"],
	["John.Doe+github@yahoo.pt", "john.doe@yahoo.pt"],
	["John.Doe@yahoo.pt", "john.doe@yahoo.pt"],
	["John.Doe+github@yahoo.ro", "john.doe@yahoo.ro"],
	["John.Doe@yahoo.ro", "john.doe@yahoo.ro"],
	["John.Doe+github@yahoo.ru", "john.doe@yahoo.ru"],
	["John.Doe@yahoo.ru", "john.doe@yahoo.ru"],
	["John.Doe+github@yahoo.com.sg", "john.doe@yahoo.com.sg"],
	["John.Doe@yahoo.com.sg", "john.doe@yahoo.com.sg"],
	["John.Doe+github@yahoo.co.za", "john.doe@yahoo.co.za"],
	["John.Doe@yahoo.co.za", "john.doe@yahoo.co.za"],
	["John.Doe+github@yahoo.es", "john.doe@yahoo.es"],
	["John.Doe@yahoo.es", "john.doe@yahoo.es"],
	["John.Doe+github@yahoo.se", "john.doe@yahoo.se"],
	["John.Doe@yahoo.se", "john.doe@yahoo.se"],
	["John.Doe+github@yahoo.ch/fr", "john.doe@yahoo.ch/fr"],
	["John.Doe@yahoo.ch/fr", "john.doe@yahoo.ch/fr"],
	["John.Doe+github@yahoo.ch/de", "john.doe@yahoo.ch/de"],
	["John.Doe@yahoo.ch/de", "john.doe@yahoo.ch/de"],
	["John.Doe+github@yahoo.com.tw", "john.doe@yahoo.com.tw"],
	["John.Doe@yahoo.com.tw", "john.doe@yahoo.com.tw"],
	["John.Doe+github@yahoo.co.th", "john.doe@yahoo.co.th"],
	["John.Doe@yahoo.co.th", "john.doe@yahoo.co.th"],
	["John.Doe+github@yahoo.com.tr", "john.doe@yahoo.com.tr"],
	["John.Doe@yahoo.com.tr", "john.doe@yahoo.com.tr"],
	["John.Doe+github@yahoo.co.uk", "john.doe@yahoo.co.uk"],
	["John.Doe@yahoo.co.uk", "john.doe@yahoo.co.uk"],
	["John.Doe+github@yahoo.com", "john.doe@yahoo.com"],
	["John.Doe@yahoo.com", "john.doe@yahoo.com"],
	["John.Doe+github@yahoo.com.vn", "john.doe@yahoo.com.vn"],
	["John.Doe@yahoo.com.vn", "john.doe@yahoo.com.vn"],
	["John.Doe+github@ymail.com", "john.doe@ymail.com"],
	["John.Doe@ymail.com", "john.doe@ymail.com"],
	["John.Doe+github@yahoodns.net", "john.doe@yahoodns.net"],
	["John.Doe@yahoodns.net", "john.doe@yahoodns.net"],
	["John.Doe+github@gmail.com", "johndoe@gmail.com"],
	["John.Doe@gmail.com", "johndoe@gmail.com"],
	["john.doe+github@googlemail.com", "johndoe@gmail.com"],
	["john.doe@googlemail.com", "johndoe@gmail.com"],
	["john.doe+github@google.com", "johndoe@google.com"],
	["john.doe@google.com", "johndoe@google.com"],
	["John.Doe+github@hotmail.com", "john.doegithub@hotmail.com"],
	["John.Doe@hotmail.com", "john.doe@hotmail.com"],
	["John.Doe+github@hotmail.at", "john.doegithub@hotmail.at"],
	["John.Doe@hotmail.at", "john.doe@hotmail.at"],
	["John.Doe+github@hotmail.be", "john.doegithub@hotmail.be"],
	["John.Doe@hotmail.be", "john.doe@hotmail.be"],
	["John.Doe+github@hotmail.ca", "john.doegithub@hotmail.ca"],
	["John.Doe@hotmail.ca", "john.doe@hotmail.ca"],
	["John.Doe+github@hotmail.cl", "john.doegithub@hotmail.cl"],
	["John.Doe@hotmail.cl", "john.doe@hotmail.cl"],
	["John.Doe+github@hotmail.co.il", "john.doegithub@hotmail.co.il"],
	["John.Doe@hotmail.co.il", "john.doe@hotmail.co.il"],
	["John.Doe+github@hotmail.co.nz", "john.doegithub@hotmail.co.nz"],
	["John.Doe@hotmail.co.nz", "john.doe@hotmail.co.nz"],
	["John.Doe+github@hotmail.co.th", "john.doegithub@hotmail.co.th"],
	["John.Doe@hotmail.co.th", "john.doe@hotmail.co.th"],
	["John.Doe+github@hotmail.co.uk", "john.doegithub@hotmail.co.uk"],
	["John.Doe@hotmail.co.uk", "john.doe@hotmail.co.uk"],
	["John.Doe+github@hotmail.com.ar", "john.doegithub@hotmail.com.ar"],
	["John.Doe@hotmail.com.ar", "john.doe@hotmail.com.ar"],
	["John.Doe+github@hotmail.com.au", "john.doegithub@hotmail.com.au"],
	["John.Doe@hotmail.com.au", "john.doe@hotmail.com.au"],
	["John.Doe+github@hotmail.com.br", "john.doegithub@hotmail.com.br"],
	["John.Doe@hotmail.com.br", "john.doe@hotmail.com.br"],
	["John.Doe+github@hotmail.com.gr", "john.doegithub@hotmail.com.gr"],
	["John.Doe@hotmail.com.gr", "john.doe@hotmail.com.gr"],
	["John.Doe+github@hotmail.com.mx", "john.doegithub@hotmail.com.mx"],
	["John.Doe@hotmail.com.mx", "john.doe@hotmail.com.mx"],
	["John.Doe+github@hotmail.com.pe", "john.doegithub@hotmail.com.pe"],
	["John.Doe@hotmail.com.pe", "john.doe@hotmail.com.pe"],
	["John.Doe+github@hotmail.com.tr", "john.doegithub@hotmail.com.tr"],
	["John.Doe@hotmail.com.tr", "john.doe@hotmail.com.tr"],
	["John.Doe+github@hotmail.com.vn", "john.doegithub@hotmail.com.vn"],
	["John.Doe@hotmail.com.vn", "john.doe@hotmail.com.vn"],
	["John.Doe+github@hotmail.cz", "john.doegithub@hotmail.cz"],
	["John.Doe@hotmail.cz", "john.doe@hotmail.cz"],
	["John.Doe+github@hotmail.de", "john.doegithub@hotmail.de"],
	["John.Doe@hotmail.de", "john.doe@hotmail.de"],
	["John.Doe+github@hotmail.dk", "john.doegithub@hotmail.dk"],
	["John.Doe@hotmail.dk", "john.doe@hotmail.dk"],
	["John.Doe+github@hotmail.es", "john.doegithub@hotmail.es"],
	["John.Doe@hotmail.es", "john.doe@hotmail.es"],
	["John.Doe+github@hotmail.fr", "john.doegithub@hotmail.fr"],
	["John.Doe@hotmail.fr", "john.doe@hotmail.fr"],
	["John.Doe+github@hotmail.hu", "john.doegithub@hotmail.hu"],
	["John.Doe@hotmail.hu", "john.doe@hotmail.hu"],
	["John.Doe+github@hotmail.id", "john.doegithub@hotmail.id"],
	["John.Doe@hotmail.id", "john.doe@hotmail.id"],
	["John.Doe+github@hotmail.ie", "john.doegithub@hotmail.ie"],
	["John.Doe@hotmail.ie", "john.doe@hotmail.ie"],
	["John.Doe+github@hotmail.in", "john.doegithub@hotmail.in"],
	["John.Doe@hotmail.in", "john.doe@hotmail.in"],
	["John.Doe+github@hotmail.it", "john.doegithub@hotmail.it"],
	["John.Doe@hotmail.it", "john.doe@hotmail.it"],
	["John.Doe+github@hotmail.jp", "john.doegithub@hotmail.jp"],
	["John.Doe@hotmail.jp", "john.doe@hotmail.jp"],
	["John.Doe+github@hotmail.kr", "john.doegithub@hotmail.kr"],
	["John.Doe@hotmail.kr", "john.doe@hotmail.kr"],
	["John.Doe+github@hotmail.lv", "john.doegithub@hotmail.lv"],
	["John.Doe@hotmail.lv", "john.doe@hotmail.lv"],
	["John.Doe+github@hotmail.my", "john.doegithub@hotmail.my"],
	["John.Doe@hotmail.my", "john.doe@hotmail.my"],
	["John.Doe+github@hotmail.ph", "john.doegithub@hotmail.ph"],
	["John.Doe@hotmail.ph", "john.doe@hotmail.ph"],
	["John.Doe+github@hotmail.pt", "john.doegithub@hotmail.pt"],
	["John.Doe@hotmail.pt", "john.doe@hotmail.pt"],
	["John.Doe+github@hotmail.sa", "john.doegithub@hotmail.sa"],
	["John.Doe@hotmail.sa", "john.doe@hotmail.sa"],
	["John.Doe+github@hotmail.sg", "john.doegithub@hotmail.sg"],
	["John.Doe@hotmail.sg", "john.doe@hotmail.sg"],
	["John.Doe+github@hotmail.sk", "john.doegithub@hotmail.sk"],
	["John.Doe@hotmail.sk", "john.doe@hotmail.sk"],
	["John.Doe+github@live.com", "john.doegithub@live.com"],
	["John.Doe@live.com", "john.doe@live.com"],
	["John.Doe+github@live.be", "john.doegithub@live.be"],
	["John.Doe@live.be", "john.doe@live.be"],
	["John.Doe+github@live.co.uk", "john.doegithub@live.co.uk"],
	["John.Doe@live.co.uk", "john.doe@live.co.uk"],
	["John.Doe+github@live.com.ar", "john.doegithub@live.com.ar"],
	["John.Doe@live.com.ar", "john.doe@live.com.ar"],
	["John.Doe+github@live.com.mx", "john.doegithub@live.com.mx"],
	["John.Doe@live.com.mx", "john.doe@live.com.mx"],
	["John.Doe+github@live.de", "john.doegithub@live.de"],
	["John.Doe@live.de", "john.doe@live.de"],
	["John.Doe+github@live.es", "john.doegithub@live.es"],
	["John.Doe@live.es", "john.doe@live.es"],
	["John.Doe+github@live.eu", "john.doegithub@live.eu"],
	["John.Doe@live.eu", "john.doe@live.eu"],
	["John.Doe+github@live.fr", "john.doegithub@live.fr"],
	["John.Doe@live.fr", "john.doe@live.fr"],
	["John.Doe+github@live.it", "john.doegithub@live.it"],
	["John.Doe@live.it", "john.doe@live.it"],
	["John.Doe+github@live.nl", "john.doegithub@live.nl"],
	["John.Doe@live.nl", "john.doe@live.nl"],
	["John.Doe+github@msn.com", "john.doegithub@msn.com"],
	["John.Doe@msn.com", "john.doe@msn.com"],
	["John.Doe+github@outlook.com", "john.doegithub@outlook.com"],
	["John.Doe@outlook.com", "john.doe@outlook.com"],
	["John.Doe+github@outlook.at", "john.doegithub@outlook.at"],
	["John.Doe@outlook.at", "john.doe@outlook.at"],
	["John.Doe+github@outlook.be", "john.doegithub@outlook.be"],
	["John.Doe@outlook.be", "john.doe@outlook.be"],
	["John.Doe+github@outlook.cl", "john.doegithub@outlook.cl"],
	["John.Doe@outlook.cl", "john.doe@outlook.cl"],
	["John.Doe+github@outlook.co.il", "john.doegithub@outlook.co.il"],
	["John.Doe@outlook.co.il", "john.doe@outlook.co.il"],
	["John.Doe+github@outlook.co.nz", "john.doegithub@outlook.co.nz"],
	["John.Doe@outlook.co.nz", "john.doe@outlook.co.nz"],
	["John.Doe+github@outlook.co.th", "john.doegithub@outlook.co.th"],
	["John.Doe@outlook.co.th", "john.doe@outlook.co.th"],
	["John.Doe+github@outlook.com.ar", "john.doegithub@outlook.com.ar"],
	["John.Doe@outlook.com.ar", "john.doe@outlook.com.ar"],
	["John.Doe+github@outlook.com.au", "john.doegithub@outlook.com.au"],
	["John.Doe@outlook.com.au", "john.doe@outlook.com.au"],
	["John.Doe+github@outlook.com.br", "john.doegithub@outlook.com.br"],
	["John.Doe@outlook.com.br", "john.doe@outlook.com.br"],
	["John.Doe+github@outlook.com.gr", "john.doegithub@outlook.com.gr"],
	["John.Doe@outlook.com.gr", "john.doe@outlook.com.gr"],
	["John.Doe+github@outlook.com.pe", "john.doegithub@outlook.com.pe"],
	["John.Doe@outlook.com.pe", "john.doe@outlook.com.pe"],
	["John.Doe+github@outlook.com.tr", "john.doegithub@outlook.com.tr"],
	["John.Doe@outlook.com.tr", "john.doe@outlook.com.tr"],
	["John.Doe+github@outlook.com.vn", "john.doegithub@outlook.com.vn"],
	["John.Doe@outlook.com.vn", "john.doe@outlook.com.vn"],
	["John.Doe+github@outlook.cz", "john.doegithub@outlook.cz"],
	["John.Doe@outlook.cz", "john.doe@outlook.cz"],
	["John.Doe+github@outlook.de", "john.doegithub@outlook.de"],
	["John.Doe@outlook.de", "john.doe@outlook.de"],
	["John.Doe+github@outlook.dk", "john.doegithub@outlook.dk"],
	["John.Doe@outlook.dk", "john.doe@outlook.dk"],
	["John.Doe+github@outlook.es", "john.doegithub@outlook.es"],
	["John.Doe@outlook.es", "john.doe@outlook.es"],
	["John.Doe+github@outlook.fr", "john.doegithub@outlook.fr"],
	["John.Doe@outlook.fr", "john.doe@outlook.fr"],
	["John.Doe+github@outlook.hu", "john.doegithub@outlook.hu"],
	["John.Doe@outlook.hu", "john.doe@outlook.hu"],
	["John.Doe+github@outlook.id", "john.doegithub@outlook.id"],
	["John.Doe@outlook.id", "john.doe@outlook.id"],
	["John.Doe+github@outlook.ie", "john.doegithub@outlook.ie"],
	["John.Doe@outlook.ie", "john.doe@outlook.ie"],
	["John.Doe+github@outlook.in", "john.doegithub@outlook.in"],
	["John.Doe@outlook.in", "john.doe@outlook.in"],
	["John.Doe+github@outlook.it", "john.doegithub@outlook.it"],
	["John.Doe@outlook.it", "john.doe@outlook.it"],
	["John.Doe+github@outlook.jp", "john.doegithub@outlook.jp"],
	["John.Doe@outlook.jp", "john.doe@outlook.jp"],
	["John.Doe+github@outlook.kr", "john.doegithub@outlook.kr"],
	["John.Doe@outlook.kr", "john.doe@outlook.kr"],
	["John.Doe+github@outlook.lv", "john.doegithub@outlook.lv"],
	["John.Doe@outlook.lv", "john.doe@outlook.lv"],
	["John.Doe+github@outlook.my", "john.doegithub@outlook.my"],
	["John.Doe@outlook.my", "john.doe@outlook.my"],
	["John.Doe+github@outlook.ph", "john.doegithub@outlook.ph"],
	["John.Doe@outlook.ph", "john.doe@outlook.ph"],
	["John.Doe+github@outlook.pt", "john.doegithub@outlook.pt"],
	["John.Doe@outlook.pt", "john.doe@outlook.pt"],
	["John.Doe+github@outlook.sa", "john.doegithub@outlook.sa"],
	["John.Doe@outlook.sa", "john.doe@outlook.sa"],
	["John.Doe+github@outlook.sg", "john.doegithub@outlook.sg"],
	["John.Doe@outlook.sg", "john.doe@outlook.sg"],
	["John.Doe+github@outlook.sk", "john.doegithub@outlook.sk"],
	["John.Doe@outlook.sk", "john.doe@outlook.sk"],
	["John.Doe+github@passport.com", "john.doegithub@passport.com"],
	["John.Doe@passport.com", "john.doe@passport.com"],
	["John.Doe+github-com@narod.ru", "john.doegithubcom@narod.ru"],
	["John.Doe@narod.ru", "john.doe@narod.ru"],
	["John.Doe+github-com@yandex.ru", "john.doegithubcom@yandex.ru"],
	["John.Doe@yandex.ru", "john.doe@yandex.ru"],
	["John.Doe+github-com@yandex.org", "john.doegithubcom@yandex.org"],
	["John.Doe@yandex.org", "john.doe@yandex.org"],
	["John.Doe+github-com@yandex.net", "john.doegithubcom@yandex.net"],
	["John.Doe@yandex.net", "john.doe@yandex.net"],
	["John.Doe+github-com@yandex.net.ru", "john.doegithubcom@yandex.net.ru"],
	["John.Doe@yandex.net.ru", "john.doe@yandex.net.ru"],
	["John.Doe+github-com@yandex.com.ru", "john.doegithubcom@yandex.com.ru"],
	["John.Doe@yandex.com.ru", "john.doe@yandex.com.ru"],
	["John.Doe+github-com@yandex.ua", "john.doegithubcom@yandex.ua"],
	["John.Doe@yandex.ua", "john.doe@yandex.ua"],
	["John.Doe+github-com@yandex.com.ua", "john.doegithubcom@yandex.com.ua"],
	["John.Doe@yandex.com.ua", "john.doe@yandex.com.ua"],
	["John.Doe+github-com@yandex.by", "john.doegithubcom@yandex.by"],
	["John.Doe@yandex.by", "john.doe@yandex.by"],
	["John.Doe+github-com@yandex.eu", "john.doegithubcom@yandex.eu"],
	["John.Doe@yandex.eu", "john.doe@yandex.eu"],
	["John.Doe+github-com@yandex.ee", "john.doegithubcom@yandex.ee"],
	["John.Doe@yandex.ee", "john.doe@yandex.ee"],
	["John.Doe+github-com@yandex.lt", "john.doegithubcom@yandex.lt"],
	["John.Doe@yandex.lt", "john.doe@yandex.lt"],
	["John.Doe+github-com@yandex.lv", "john.doegithubcom@yandex.lv"],
	["John.Doe@yandex.lv", "john.doe@yandex.lv"],
	["John.Doe+github-com@yandex.md", "john.doegithubcom@yandex.md"],
	["John.Doe@yandex.md", "john.doe@yandex.md"],
	["John.Doe+github-com@yandex.uz", "john.doegithubcom@yandex.uz"],
	["John.Doe@yandex.uz", "john.doe@yandex.uz"],
	["John.Doe+github-com@yandex.mx", "john.doegithubcom@yandex.mx"],
	["John.Doe@yandex.mx", "john.doe@yandex.mx"],
	["John.Doe+github-com@yandex.do", "john.doegithubcom@yandex.do"],
	["John.Doe@yandex.do", "john.doe@yandex.do"],
	["John.Doe+github-com@yandex.tm", "john.doegithubcom@yandex.tm"],
	["John.Doe@yandex.tm", "john.doe@yandex.tm"],
	["John.Doe+github-com@yandex.de", "john.doegithubcom@yandex.de"],
	["John.Doe@yandex.de", "john.doe@yandex.de"],
	["John.Doe+github-com@yandex.ie", "john.doegithubcom@yandex.ie"],
	["John.Doe@yandex.ie", "john.doe@yandex.ie"],
	["John.Doe+github-com@yandex.in", "john.doegithubcom@yandex.in"],
	["John.Doe@yandex.in", "john.doe@yandex.in"],
	["John.Doe+github-com@yandex.qa", "john.doegithubcom@yandex.qa"],
	["John.Doe@yandex.qa", "john.doe@yandex.qa"],
	["John.Doe+github-com@yandex.so", "john.doegithubcom@yandex.so"],
	["John.Doe@yandex.so", "john.doe@yandex.so"],
	["John.Doe+github-com@yandex.nu", "john.doegithubcom@yandex.nu"],
	["John.Doe@yandex.nu", "john.doe@yandex.nu"],
	["John.Doe+github-com@yandex.tj", "john.doegithubcom@yandex.tj"],
	["John.Doe@yandex.tj", "john.doe@yandex.tj"],
	["John.Doe+github-com@yandex.dk", "john.doegithubcom@yandex.dk"],
	["John.Doe@yandex.dk", "john.doe@yandex.dk"],
	["John.Doe+github-com@yandex.es", "john.doegithubcom@yandex.es"],
	["John.Doe@yandex.es", "john.doe@yandex.es"],
	["John.Doe+github-com@yandex.pt", "john.doegithubcom@yandex.pt"],
	["John.Doe@yandex.pt", "john.doe@yandex.pt"],
	["John.Doe+github-com@yandex.kz", "john.doegithubcom@yandex.kz"],
	["John.Doe@yandex.kz", "john.doe@yandex.kz"],
	["John.Doe+github-com@yandex.pl", "john.doegithubcom@yandex.pl"],
	["John.Doe@yandex.pl", "john.doe@yandex.pl"],
	["John.Doe+github-com@yandex.lu", "john.doegithubcom@yandex.lu"],
	["John.Doe@yandex.lu", "john.doe@yandex.lu"],
	["John.Doe+github-com@yandex.it", "john.doegithubcom@yandex.it"],
	["John.Doe@yandex.it", "john.doe@yandex.it"],
	["John.Doe+github-com@yandex.az", "john.doegithubcom@yandex.az"],
	["John.Doe@yandex.az", "john.doe@yandex.az"],
	["John.Doe+github-com@yandex.ro", "john.doegithubcom@yandex.ro"],
	["John.Doe@yandex.ro", "john.doe@yandex.ro"],
	["John.Doe+github-com@yandex.rs", "john.doegithubcom@yandex.rs"],
	["John.Doe@yandex.rs", "john.doe@yandex.rs"],
	["John.Doe+github-com@yandex.sk", "john.doegithubcom@yandex.sk"],
	["John.Doe@yandex.sk", "john.doe@yandex.sk"],
	["John.Doe+github-com@yandex.no", "john.doegithubcom@yandex.no"],
	["John.Doe@yandex.no", "john.doe@yandex.no"],
	["John.Doe+github-com@ya.ru", "john.doegithubcom@ya.ru"],
	["John.Doe@ya.ru", "john.doe@ya.ru"],
	["John.Doe+github-com@yandex.com", "john.doegithubcom@yandex.com"],
	["John.Doe@yandex.com", "john.doe@yandex.com"],
	["John.Doe+github-com@yandex.asia", "john.doegithubcom@yandex.asia"],
	["John.Doe@yandex.asia", "john.doe@yandex.asia"],
	["John.Doe+github-com@yandex.mobi", "john.doegithubcom@yandex.mobi"],
	["John.Doe@yandex.mobi", "john.doe@yandex.mobi"],
	["John.Doe+github@protonmail.ch", "johndoe@protonmail.ch"],
	["jOHn-dOE_marketing@protonmail.ch", "johndoemarketing@protonmail.ch"],
	["John.Doe@protonmail.ch", "johndoe@protonmail.ch"],
	["John.Doe+github@protonmail.com", "johndoe@protonmail.com"],
	["jOHn-dOE_marketing@protonmail.com", "johndoemarketing@protonmail.com"],
	["John.Doe@protonmail.com", "johndoe@protonmail.com"],
	["John.Doe+github@proton.me", "johndoe@proton.me"],
	["jOHn-dOE_marketing@proton.me", "johndoemarketing@proton.me"],
	["John.Doe@proton.me", "johndoe@proton.me"],
	["John.Doe+github@pm.me", "johndoe@pm.me"],
	["jOHn-dOE_marketing@pm.me", "johndoemarketing@pm.me"],
	["John.Doe@pm.me", "johndoe@pm.me"],
	["JohnDoe@purelymail.com", "johndoe@purelymail.com"],
	["JohnDoe+github@purelymail.com", "johndoe@purelymail.com"],
	["jOHndoe^marketing@purelymail.com", "johndoe@purelymail.com"],
	["John.Doe@purelymail.com", "john@purelymail.com"],
	["JohnDoe@cheapermail.com", "johndoe@cheapermail.com"],
	["JohnDoe+github@cheapermail.com", "johndoe@cheapermail.com"],
	["jOHndoe^marketing@cheapermail.com", "johndoe@cheapermail.com"],
	["John.Doe@cheapermail.com", "john@cheapermail.com"],
	["JohnDoe@placeq.com", "johndoe@placeq.com"],
	["JohnDoe+github@placeq.com", "johndoe@placeq.com"],
	["jOHndoe^marketing@placeq.com", "johndoe@placeq.com"],
	["John.Doe@placeq.com", "john@placeq.com"],
	["JohnDoe@rethinkmail.com", "johndoe@rethinkmail.com"],
	["JohnDoe+github@rethinkmail.com", "johndoe@rethinkmail.com"],
	["jOHndoe^marketing@rethinkmail.com", "johndoe@rethinkmail.com"],
	["John.Doe@rethinkmail.com", "john@rethinkmail.com"],
	["JohnDoe@worldofmail.com", "johndoe@worldofmail.com"],
	["JohnDoe+github@worldofmail.com", "johndoe@worldofmail.com"],
	["jOHndoe^marketing@worldofmail.com", "johndoe@worldofmail.com"],
	["John.Doe@worldofmail.com", "john@worldofmail.com"],
])("normalizeEmail('%s') returns '%s'", async (input, expected) => {
	await expect(normalizeEmail(input)).resolves.toStrictEqual(expected);
});

test.each([
	["github-actions+ignore@reinaldyrafli.com", "github@reinaldyrafli.com"], // Uses Purelymail
	["john.doe+marketing@sentry.io", "johndoe@sentry.io"], // Uses Google
	["john.doe+marketing@lever.co", "john.doemarketing@lever.co"], // Uses Outlook/Microsoft
	["john.doe+marketing@instagram.com", "john.doe+marketing@instagram.com"], // Uses Oracle Cloud (*.pphosted.com)
	["john.doe@debian.org", "john.doe@debian.org"], // Uses custom (*.debian.org)
	["john.doe+marketing@free.technology", "johndoe@free.technology"], // Uses Protonmail
	["john.doe+marketing@signal.org", "johndoe@signal.org"], // Uses Google
	["john.doe@ripple.com", "john.doe@ripple.com"], // Uses Oracle Cloud (*.pphosted.com)
	["john.doe@helionenergy.com", "john.doe@helionenergy.com"], // Uses Microsoft (office365.us)
	["john.doe+marketing@orb.aero", "john.doemarketing@orb.aero"], // Uses Microsoft (outlook.com)
	["john.doe@avoidwork.com", "john.doe@avoidwork.com"], // Uses Zoho
	[
		"john.doe+marketing@teknologiumum.com",
		"john.doe+marketing@teknologiumum.com",
	], // Behind Cloudflare's MX
	["john.doe+marketing@celeryq.dev", "john.doe+marketing@celeryq.dev"], // Uses custom (eforward*.registrar-servers.com)
	["john.doe+marketing@martinfowler.com", "johndoe@martinfowler.com"], // Uses Google with uppercased DNS entries
	["john.doe+marketing@topicbox.com", "john.doe@topicbox.com"], // Uses Fastmail (messagingengine.com)
	["john.doe+marketing@tesla.com", "john.doemarketing@tesla.com"], // Uses Microsoft (outlook.com)
	["john.doe+marketing@standardnotes.com", "johndoe@standardnotes.com"], // Uses Protonmail (protonmail.ch)
	["john.doe+marketing@notesnook.com", "john.doe+marketing@notesnook.com"], // Uses Zoho (zoho.com)
])(
	"normalizeEmail('%s', { resolveMX: true }) returns '%s'",
	async (input, expected) => {
		await expect(
			normalizeEmail(input, { resolveMX: true }),
		).resolves.toStrictEqual(expected);
	},
);

test.each([
	["", ""],
	["noreply", "noreply"],
])("invalid email address '%s' returns '%s'", async (input, expected) => {
	await expect(normalizeEmail(input)).resolves.toStrictEqual(expected);
});
